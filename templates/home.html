<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
            integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
            crossorigin="anonymous"
        />
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
            integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
            crossorigin="anonymous"
        ></script>
        <title>Document</title>
    </head>
    <body>
        <div class="h-100 d-flex justify-content-center align-items-center">
            <div class="d-inline-flex flex-column">
                <label for="token" class="pad white">Enter Access Token:</label>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="basic-addon1"
                            >T</span
                        >
                    </div>
                    <input
                        type="text"
                        class="form-control"
                        placeholder="token"
                        aria-label="Token"
                        aria-describedby="basic-addon1"
                        id="token"
                    />
                </div>
                <button
                    id="ledon"
                    type="button"
                    class="btn btn-outline-success"
                >
                    Led On
                </button>
                <br />
                <button
                    id="ledoff"
                    type="button"
                    class="btn btn-outline-danger"
                >
                    Led Off
                </button>
                <br />
                <button
                    id="buzzeron"
                    type="button"
                    class="btn btn-outline-success"
                >
                    Buzzer On
                </button>
                <br />
                <button
                    id="buzzeroff"
                    type="button"
                    class="btn btn-outline-danger"
                >
                    Buzzer Off
                </button>
                <br />
                <div
                    class="alert alert-success"
                    id="alertS"
                    style="display: none"
                >
                    <strong>Success!</strong> Action successful.
                </div>
                <div
                    class="alert alert-danger"
                    id="alertD"
                    style="display: none"
                >
                    <strong>Error :(</strong> Action un-successful.
                </div>
            </div>
        </div>
        <style>
            * {
                box-sizing: border-box;
            }
            body {
                background-image: url("/static/background.jpg");
                height: 100vh;
            }
            .pad {
                padding-top: 5%;
            }

            .white {
                color: white;
            }
        </style>

        <script>
            const btnOn = document.getElementById("ledon");
            const btnOff = document.getElementById("ledoff");
            const buzzerOn = document.getElementById("buzzeron");
            const buzzerOff = document.getElementById("buzzeroff");
            const url = window.location.host;
            let sa = document.getElementById("alertS");
            let da = document.getElementById("alertD");

            const hide = (element) => {
                element.style.display = "none";
            };

            btnOn.addEventListener("click", async (e) => {
                try {
                    let token = document.getElementById("token").value;
                    const res = await fetch(`/ledon?token=${token}`);
                    const data = await res.json();
                    if (data.data == true) {
                        sa.style.display = "inline";
                        setTimeout(() => {
                            hide(sa);
                        }, 3000);
                    } else {
                        da.style.display = "inline";
                        setTimeout(() => {
                            hide(da);
                        }, 3000);
                    }
                    console.log(data);
                } catch (e) {
                    console.log(e);
                    da.style.display = "inline";
                    setTimeout(() => {
                        hide(da);
                    }, 3000);
                }
            });

            btnOff.addEventListener("click", async (e) => {
                try {
                    let token = document.getElementById("token").value;
                    const res = await fetch(`/ledoff?token=${token}`);
                    const data = await res.json();
                    if (data.data == true) {
                        sa.style.display = "inline";
                        setTimeout(() => {
                            hide(sa);
                        }, 3000);
                    } else {
                        da.style.display = "inline";
                        setTimeout(() => {
                            hide(da);
                        }, 3000);
                    }
                    console.log(data);
                } catch (e) {
                    console.log(e);
                    da.style.display = "inline";
                    setTimeout(() => {
                        hide(da);
                    }, 3000);
                }
            });

            buzzerOn.addEventListener("click", async (e) => {
                try {
                    let token = document.getElementById("token").value;
                    const res = await fetch(`/buzzeron?token=${token}`);
                    const data = await res.json();
                    if (data.data == true) {
                        sa.style.display = "inline";
                        setTimeout(() => {
                            hide(sa);
                        }, 3000);
                    } else {
                        da.style.display = "inline";
                        setTimeout(() => {
                            hide(da);
                        }, 3000);
                    }
                    console.log(data);
                } catch (e) {
                    console.log(e);
                    da.style.display = "inline";
                    setTimeout(() => {
                        hide(da);
                    }, 3000);
                }
            });

            buzzerOff.addEventListener("click", async (e) => {
                try {
                    let token = document.getElementById("token").value;
                    const res = await fetch(`/buzzeroff?token=${token}`);
                    const data = await res.json();
                    if (data.data == true) {
                        sa.style.display = "inline";
                        setTimeout(() => {
                            hide(sa);
                        }, 3000);
                    } else {
                        da.style.display = "inline";
                        setTimeout(() => {
                            hide(da);
                        }, 3000);
                    }
                    console.log(data);
                } catch (e) {
                    console.log(e);
                    da.style.display = "inline";
                    setTimeout(() => {
                        hide(da);
                    }, 3000);
                }
            });
        </script>
    </body>
</html>
